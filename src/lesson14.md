# 课时十四：平面图

> **考点分布**
> 
> | 考点 | 重要程度 | 分值 | 常见题型 |
> |------|---------|------|---------|
> | 1. 平面图的基本概念 | ★★★ | 0 ~ 4 | 选择 |
> | 2. 欧拉公式 | ★★★ | 0 ~ 6 | 选择、解答 |

---

## 1. 平面图的基本概念

### 📖 基本概念

#### 1.1 二部图

设无向图 \\(G = \\langle V,E \\rangle\\)，若能将 \\(V\\) 划分成 \\(V_1\\) 和 \\(V_2\\)（即 \\(V_1 \\cup V_2 = V\\)，\\(V_1 \\cap V_2 = \\emptyset\\) 且 \\(V_1 \\neq \\emptyset, V_2 \\neq \\emptyset\\)），使得 \\(G\\) 中的每条边的两个端点都是一个属于 \\(V_1\\)，另一个属于 \\(V_2\\)，则称 \\(G\\) 为**二部图**。

**完全二部图**：若 \\(G\\) 是二部图，\\(V_1\\) 中的每个顶点均与 \\(V_2\\) 中的所有顶点相邻，则称 \\(G\\) 为**完全二部图**，记为 \\(K_{r,s}\\)，其中 \\(r = |V_1|\\)，\\(s = |V_2|\\)。

#### 1.2 平面图

**平面图**：如果能将无向图 \\(G\\) 画在平面上使得除顶点处外无边相交，则称 \\(G\\) 为**可平面图**，简称为**平面图**。

**常见的平面图**：
- \\(K_1\\)（平凡图），\\(K_2, K_3, K_4\\) 都是平面图
- \\(K_5 - e\\)（\\(K_5\\) 删除任意一条边）也是平面图
- 完全二部图 \\(K_{1,n}(n \\geq 1)\\)，\\(K_{2,n}(n \\geq 2)\\) 都是平面图

**非平面图**：
- \\(K_5\\) 和 \\(K_{3,3}\\) 都是非平面图
- 它们都是极小非平面图（删除任意一条边后成为平面图）

#### 1.3 面

给定平面图 \\(G\\) 的平面嵌入，\\(G\\) 的边将平面划分成若干个区域，每个区域都称作 \\(G\\) 的一个**面**，包围每个面的所有边的回路组称作该面的**边界**，边界的长度称作该面的**次数**。

**重要性质**：平面图所有面的次数之和等于边数的两倍。

#### 1.4 库拉托夫斯基定理（Kuratowski's Theorem）

**定理**：一个图是平面图当且仅当它不包含 \\\\(K_5\\\\) 或 \\\\(K_{3,3}\\\\) 的**细分**作为子图。

**细分**：在图的边上插入新的顶点，将一条边分割成多条边。

**应用**：
- 这是平面图的**充要条件**
- 可用于证明图是非平面图
- 但判断细分的存在在实际中可能较复杂

#### 1.5 瓦格纳定理（Wagner's Theorem）

**定理**：一个图是平面图当且仅当它不包含 \\\\(K_5\\\\) 或 \\\\(K_{3,3}\\\\) 作为**子式**。

**子式**：通过删除顶点、删除边、收缩边得到的图。

**与库拉托夫斯基定理的关系**：
- 两者等价，但瓦格纳定理更便于算法化判定
- 子式操作比细分操作更适合计算机实现

#### 1.6 平面性测试算法

**Hopcroft-Tarjan算法**：
- **时间复杂度**：O(n)
- **基本思想**：深度优先搜索，利用回边判断平面性
- **应用**：现代平面性测试的基础算法

**简单判定方法**：
1. **检查必要条件**：若 \\\\(m > 3n - 6\\\\)，则一定非平面
2. **检查子图**：寻找 \\\\(K_5\\\\) 或 \\\\(K_{3,3}\\\\) 的细分或子式
3. **欧拉公式验证**：若已知面数，验证 \\\\(n - m + r = 2\\\\)

### 📖 对偶图（Dual Graph）

**定义**：给定平面图 \\\\(G\\\\)，构造图 \\\\(G^*\\\\)：
- \\\\(G^*\\\\) 的每个顶点对应 \\\\(G\\\\) 的一个面
- \\\\(G^*\\\\) 的每条边对应 \\\\(G\\\\) 中分隔两个面的边

**性质**：
- \\\\(G^{**} = G\\\\)（对偶的对偶是原图）
- \\\\(G\\\\) 是连通的当且仅当 \\\\(G^*\\\\) 是连通的
- \\\\(G\\\\) 的平面嵌入的对偶图是唯一的

**应用**：
- 地图着色问题
- 电路设计
- 网络流分析

### 📖 平面图与着色

**四色定理**：任何平面图都可以用至多4种颜色进行顶点着色。

**五色定理**（可证明）：任何平面图都可以用至多5种颜色进行顶点着色。

**证明思路**：
- 使用数学归纳法
- 关键引理：平面图中存在度数 ≤ 5 的顶点

### 📝 例题

**例题1**：图中（ ）是平面图。

（注：题目中有图片，需要根据图的结构判断）

<details>
<summary><strong>点击查看答案</strong></summary>

**解答**：

**判断平面图的方法**：
- 检查是否包含 \\(K_5\\) 或 \\(K_{3,3}\\) 作为子图
- 如果能重画使得边不相交，则是平面图

**答案**：A（根据图的结构判断，选项A是平面图）

</details>

---

## 2. 欧拉公式

### 📖 欧拉公式

**欧拉公式**：连通平面图 \\(G\\) 的顶点数、边数和面数分别为 \\(n, m\\) 和 \\(r\\)，则有：

\\[
n - m + r = 2
\\]

### 💡 简单平面图的必要条件

设 \\(G\\) 是 \\(n(n \\geq 3)\\) 阶 \\(m\\) 条边的简单平面图，则：

\\[
m \\leq 3n - 6
\\]

**重要说明**：
- 一个简单连通图，若不满足 \\(m \\leq 3n - 6\\)，则一定是非平面图
- 但满足该不等式的简单连通图**未必是平面图**（只是必要条件，不是充分条件）

### 📝 例题

**例题1**：设 \\(G\\) 是连通平面图，有5个顶点，6个面，则 \\(G\\) 的边数是（ ）。

A. 5条

B. 6条

C. 9条

D. 11条

<details>
<summary><strong>点击查看答案</strong></summary>

**解答**：

**使用欧拉公式**：\\(n - m + r = 2\\)

已知：\\(n = 5\\)，\\(r = 6\\)

\\[
5 - m + 6 = 2 \\Rightarrow m = 9
\\]

**答案**：C（但选项中没有9，检查题目）

重新计算：\\(5 - m + 6 = 2 \\Rightarrow m = 9\\)

但选项A是5，可能题目有误。根据欧拉公式，答案应该是9。

如果按照选项，可能是：\\(5 - 5 + 6 = 6 \\neq 2\\)，不对。

**正确答案**：根据欧拉公式，\\(m = n + r - 2 = 5 + 6 - 2 = 9\\)

但选项中没有9，可能是题目数据有误。按公式计算应该是9。

</details>

---

**例题2**：图 \\(G\\) 是一个简单的连通平面图，顶点数为8，其无限面的次数为5，其余面都为三角形（次数为3），计算平面图的边数和面数。

<details>
<summary><strong>点击查看答案</strong></summary>

**解答**：

**设平面图 \\(G\\) 的边数为 \\(m\\)，面数为 \\(r\\)**

**使用欧拉公式**：
\\[
n - m + r = 2 \\Rightarrow 8 - m + r = 2
\\]

**使用面的次数性质**：
所有面的次数之和 = \\(2m\\)

\\[
5 + 3(r - 1) = 2m
\\]

**联立求解**：
\\[
\\begin{cases}
8 - m + r = 2 \\\\
5 + 3(r - 1) = 2m
\\end{cases}
\\]

\\[
\\begin{cases}
m = r + 6 \\\\
5 + 3r - 3 = 2m \\\\
2 + 3r = 2(r + 6) \\\\
2 + 3r = 2r + 12 \\\\
r = 10 \\\\
m = 16
\\end{cases}
\\]

**答案**：边数为16，面数为10

</details>

---

**例题3**：设图 \\(G\\) 有 \\(V\\) 个结点 \\(e\\) 条边，当 \\(V > 3\\)，若不满足 \\(e \\leq 3V - 6\\)，它一定不是平面图。（）

<details>
<summary><strong>点击查看答案</strong></summary>

**解答**：

**正确** ✅

**说明**：
- \\(m \\leq 3n - 6\\) 是简单平面图的**必要条件**
- 若不满足这个条件，则图一定不是平面图
- 但满足这个条件不一定就是平面图

**答案**：正确

</details>

---

## 3. 练习题

### 练习1

5个结点的简单平面图的边数最多是（ ）。

A. 7

B. 8

C. 9

D. 10

<details>
<summary><strong>点击查看答案</strong></summary>

**解答**：

**使用简单平面图的必要条件**：\\(m \\leq 3n - 6\\)

\\(n = 5\\)：
\\[
m \\leq 3 \\times 5 - 6 = 15 - 6 = 9
\\]

**答案**：C

</details>

---

### 练习2

二部图 \\(K_{2,3}\\) 是（ ）。

A. 欧拉图

B. 哈密顿图

C. 非平面图

D. 平面图

<details>
<summary><strong>点击查看答案</strong></summary>

**解答**：

**\\(K_{2,3}\\) 的性质**：

**平面性**：
- \\(K_{2,n}(n \\geq 2)\\) 都是平面图
- 所以 \\(K_{2,3}\\) 是平面图 ✅

**欧拉性**：
- 需要检查度数（无向图需要所有顶点度数为偶数）
- \\(K_{2,3}\\) 中，2个顶点的度数为3，3个顶点的度数为2
- 有奇度顶点，所以不是欧拉图 ❌

**哈密顿性**：
- 需要检查是否存在哈密顿回路
- \\(K_{2,3}\\) 不一定有哈密顿回路 ❌

**答案**：D

</details>

---

### 练习3

若简单连通图 \\(G\\) 有4个结点，3个面，则 \\(G\\) 有（ ）条边。

A. 3

B. 4

C. 5

D. 6

<details>
<summary><strong>点击查看答案</strong></summary>

**解答**：

**使用欧拉公式**：\\(n - m + r = 2\\)

已知：\\(n = 4\\)，\\(r = 3\\)

\\[
4 - m + 3 = 2 \\Rightarrow m = 5
\\]

**答案**：C

</details>

---

### 练习4

设 \\(G\\) 是连通平面图，有 \\(v\\) 个顶点，\\(e\\) 条边，\\(r\\) 个面，则 \\(v - e + r =\\underline{\\quad}\\)。

<details>
<summary><strong>点击查看答案</strong></summary>

**解答**：

**欧拉公式**：对于连通平面图，\\(n - m + r = 2\\)

**答案**：2

</details>

---

### 练习5

设简单平面图 \\(G\\) 有 \\(n\\) 个顶点，\\(m\\) 条边，且 \\(n \\geq 3\\)，则 \\(m \\leq\\underline{\\quad}\\)。

<details>
<summary><strong>点击查看答案</strong></summary>

**解答**：

**简单平面图的必要条件**：\\(m \\leq 3n - 6\\)

**答案**：\\(3n - 6\\)

</details>

---

## 📌 总结

### 关键要点

1. **平面图**：
   - 定义：能画在平面上使得除顶点处外无边相交
   - 常见的平面图：\\(K_1, K_2, K_3, K_4, K_{1,n}, K_{2,n}\\)
   - 非平面图：\\(K_5, K_{3,3}\\)

2. **欧拉公式**：
   - 连通平面图：\\(n - m + r = 2\\)
   - 其中 \\(n\\) 是顶点数，\\(m\\) 是边数，\\(r\\) 是面数

3. **简单平面图的必要条件**：
   - \\(m \\leq 3n - 6\\)（\\(n \\geq 3\\)）
   - 不满足一定不是平面图，满足不一定就是平面图

4. **面的次数**：
   - 所有面的次数之和 = \\(2m\\)

### 记忆技巧

- **欧拉公式**：\\(n - m + r = 2\\)（顶点 - 边 + 面 = 2）
- **简单平面图条件**：\\(m \\leq 3n - 6\\)
- **非平面图**：\\(K_5\\) 和 \\(K_{3,3}\\)
- **面的次数**：总和等于边数的2倍
