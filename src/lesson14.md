# 课时十四：平面图

> **考点分布**
>
> | 考点 | 重要程度 | 分值 | 常见题型 |
> |------|---------|------|---------|
> | 1. 平面图的基本概念 | ★★★ | 0 ~ 4 | 选择 |
> | 2. 欧拉公式 | ★★★ | 0 ~ 6 | 选择、解答 |

---

## 1. 平面图的基本概念

### 📖 基本概念

#### 1.1 二部图

设无向图 \(G = \langle V,E \rangle\)，若能将 \(V\) 划分成 \(V_1\) 和 \(V_2\)（即 \(V_1 \cup V_2 = V\)，\(V_1 \cap V_2 = \emptyset\) 且 \(V_1 \neq \emptyset, V_2 \neq \emptyset\)），使得 \(G\) 中的每条边的两个端点都是一个属于 \(V_1\)，另一个属于 \(V_2\)，则称 \(G\) 为**二部图**。

**完全二部图**：若 \(G\) 是二部图，\(V_1\) 中的每个顶点均与 \(V_2\) 中的所有顶点相邻，则称 \(G\) 为**完全二部图**，记为 \(K_{r,s}\)，其中 \(r = |V_1|\)，\(s = |V_2|\)。

#### 1.2 平面图

**平面图**：如果能将无向图 \(G\) 画在平面上使得除顶点处外无边相交，则称 \(G\) 为**可平面图**，简称为**平面图**。

**常见的平面图**：
- \(K_1\)（平凡图），\(K_2, K_3, K_4\) 都是平面图
- \(K_5 - e\)（\(K_5\) 删除任意一条边）也是平面图
- 完全二部图 \(K_{1,n}(n \geq 1)\)，\(K_{2,n}(n \geq 2)\) 都是平面图

**非平面图**：
- \(K_5\) 和 \(K_{3,3}\) 都是非平面图
- 它们都是极小非平面图（删除任意一条边后成为平面图）

#### 1.3 面

给定平面图 \(G\) 的平面嵌入，\(G\) 的边将平面划分成若干个区域，每个区域都称作 \(G\) 的一个**面**，包围每个面的所有边的回路组称作该面的**边界**，边界的长度称作该面的**次数**。

**重要性质**：平面图所有面的次数之和等于边数的两倍。

#### 1.4 库拉托夫斯基定理（Kuratowski's Theorem）

**定理**：一个图是平面图当且仅当它不包含 \(K_5\) 或 \(K_{3,3}\) 的**细分**作为子图。

**细分**：在图的边上插入新的顶点，将一条边分割成多条边。

**应用**：
- 这是平面图的**充要条件**
- 可用于证明图是非平面图
- 但判断细分的存在在实际中可能较复杂

#### 1.5 瓦格纳定理（Wagner's Theorem）

**定理**：一个图是平面图当且仅当它不包含 \(K_5\) 或 \(K_{3,3}\) 作为**子式**。

**子式**：通过删除顶点、删除边、收缩边得到的图。

**与库拉托夫斯基定理的关系**：
- 两者等价，但瓦格纳定理更便于算法化判定
- 子式操作比细分操作更适合计算机实现

#### 1.6 平面性测试算法

**Hopcroft-Tarjan算法**：
- **时间复杂度**：O(n)
- **基本思想**：深度优先搜索，利用回边判断平面性
- **应用**：现代平面性测试的基础算法

**简单判定方法**：
1. **检查必要条件**：若 \(m > 3n - 6\)，则一定非平面
2. **检查子图**：寻找 \(K_5\) 或 \(K_{3,3}\) 的细分或子式
3. **欧拉公式验证**：若已知面数，验证 \(n - m + r = 2\)

### 📖 对偶图（Dual Graph）

**定义**：给定平面图 \(G\)，构造图 \(G^*\)：
- \(G^*\) 的每个顶点对应 \(G\) 的一个面
- \(G^*\) 的每条边对应 \(G\) 中分隔两个面的边

**性质**：
- \(G^{**} = G\)（对偶的对偶是原图）
- \(G\) 是连通的当且仅当 \(G^*\) 是连通的
- \(G\) 的平面嵌入的对偶图是唯一的

**应用**：
- 地图着色问题
- 电路设计
- 网络流分析

### 📖 平面图与着色

**四色定理**：任何平面图都可以用至多4种颜色进行顶点着色。

**五色定理**（可证明）：任何平面图都可以用至多5种颜色进行顶点着色。

#### 五色定理的详细证明

**证明方法**：数学归纳法（对顶点数 n 进行归纳）

**关键引理**：任何平面图中都存在度数 ≤ 5 的顶点

**证明引理**：
- 设平面图有 n 个顶点，m 条边
- 若所有顶点度数 ≥ 6，则 2m = Σd(v) ≥ 6n
- 但简单平面图满足 m ≤ 3n - 6
- 所以 2m ≤ 6n - 12
- 矛盾：6n ≤ 6n - 12 不成立
- 因此必存在度数 ≤ 5 的顶点

**五色定理证明过程**：

**基础情况**：n ≤ 5 时，显然可以用 ≤ 5 种颜色着色

**归纳步骤**：假设对所有顶点数 < n 的平面图，五色定理成立

**对 n 个顶点的平面图 G**：

1. **找到度数 ≤ 5 的顶点 v**
   - 根据引理，这样的顶点一定存在

2. **删除顶点 v，得到图 G'**
   - G' 有 n-1 个顶点
   - 根据归纳假设，G' 可以用 5 种颜色着色

3. **重新加入 v 并着色**

   **情况 1**：v 的邻居 ≤ 4 个
   - 邻居最多用了 4 种颜色
   - v 可以用第 5 种颜色

   **情况 2**：v 有 5 个邻居
   - 设邻居按顺时针顺序为 v₁, v₂, v₃, v₄, v₅
   - 它们分别用了某些颜色（最多 5 种）

   **子情况 2a**：5 个邻居用了 ≤ 4 种颜色
   - v 可以用剩余的颜色

   **子情况 2b**：5 个邻居用了 5 种不同颜色
   - 考虑 v₁, v₂, v₃, v₄ 构成的子图
   - 如果 v₁ 和 v₃ 在 G' 中不连通：
     - 交换 v₁, v₃ 所在连通分量的颜色
     - 这样 v₁ 和 v₃ 颜色相同，v 可用第 5 种颜色
   - 如果 v₁ 和 v₃ 在 G' 中连通：
     - 考虑 v₂, v₄，如果它们不连通：
       - 交换 v₂, v₄ 所在连通分量的颜色
       - v₂ 和 v₄ 颜色相同，v 可用第 5 种颜色
     - 如果 v₂ 和 v₄ 也连通：
       - 这会形成包含 v 的环，与平面性矛盾
       - 因为 v₁-v₂-v₃-v₄-v₁ 会包围 v，但 v 在环内，无法连接到环外

**结论**：无论如何都能为 v 找到合适的颜色，五色定理得证。

#### 四色定理说明

**重要性**：
- 这是图论中最著名的定理之一
- 1976年由 Appel 和 Haken 首次用计算机证明
- 证明使用了大量计算机计算（约 1200 小时）
- 至今仍有争议，因为无法人工验证所有情况

**实际应用**：
- 地图着色问题
- 无线电频率分配
- 电路板布线

### 📝 实际应用与考试例题

#### 例题1：地图着色问题（高考真题风格）

**题目**：某地区有6个相邻的省份A、B、C、D、E、F，它们的相邻关系如下：
- A与B、C、D相邻
- B与A、E相邻
- C与A、D、E、F相邻
- D与A、C、F相邻
- E与B、C、F相邻
- F与C、D、E相邻

问：至少需要多少种颜色才能为这6个省份着色，使得相邻省份颜色不同？

**详细解答**：

**步骤1：转化为平面图**
```
   A---B
   |\ /|
   | C |
   |/ \|
   D---E
    \ /
     F
```
（C为中心，连接A、B、D、E、F）

**步骤2：判断图的性质**
- 顶点数：6
- 边数：AB, AC, AD, BC, CD, CE, DE, EF, CF, DF（共10条）
- 检查是否为二部图：
  - 存在三角形：A-C-D-A
  - 所以不是二部图，着色数 ≥ 3

**步骤3：寻找最大团**
- 三角形：A-C-D
- 所以至少需要3种颜色

**步骤4：实际着色**
尝试3种颜色：
- 颜色1：A, E
- 颜色2：B, D
- 颜色3：C, F

**验证**：
- A(1)与B(2), C(3), D(2) ✓
- B(2)与A(1), E(1) ✓
- C(3)与A(1), B(2), D(2), E(1), F(3) ✗（C与F同色冲突）

重新着色：
- 颜色1：A, E
- 颜色2：B, D, F
- 颜色3：C

验证：
- A(1)与B(2), C(3), D(2) ✓
- B(2)与A(1), E(1) ✓
- C(3)与A(1), B(2), D(2), E(1), F(2) ✓
- D(2)与A(1), C(3), F(2) ✗（D与F同色冲突）

再尝试：
- 颜色1：A, E
- 颜色2：B, F
- 颜色3：C, D

验证：
- A(1)与B(2), C(3), D(3) ✗（A与D不同色，但A与C、D相邻，C和D同色没问题）

最终方案：
- 颜色1：A, E
- 颜色2：B, D
- 颜色3：C, F

**答案**：最少需要3种颜色。

**实际意义**：这是地图着色的经典应用，四色定理保证最多4种颜色足够，但本题只需要3种。

---

#### 例题2：电路板布线问题

**题目**：某电路板上有5个需要连接的触点v1、v2、v3、v4、v5，它们之间的连接关系如下图。为了防止信号干扰，相邻的触点不能使用相同的布线层。问最少需要多少种布线层？

```
   v1
   |\
   | \
   v2--v3
   | /|
   |/ |
   v4--v5
```

**详细解答**：

**步骤1：分析图的结构**
- 顶点：v1, v2, v3, v4, v5
- 边：v1-v2, v1-v3, v2-v3, v2-v4, v3-v4, v3-v5, v4-v5
- 这是一个平面图

**步骤2：判断着色数**
- 检查奇环：v2-v3-v4-v2（3个顶点）→ 奇环
- 所以不是二部图，着色数 ≥ 3

**步骤3：寻找最大团**
- 三角形：v2-v3-v4
- 所以至少需要3种颜色

**步骤4：实际着色**
尝试3种颜色：
- v1: 颜色1
- v2: 颜色2
- v3: 颜色3
- v4: 颜色1（与v2=2, v3=3相邻）
- v5: 颜色2（与v3=3, v4=1相邻）

**验证**：
- v1(1)与v2(2), v3(3) ✓
- v2(2)与v1(1), v3(3), v4(1) ✓
- v3(3)与v1(1), v2(2), v4(1), v5(2) ✓
- v4(1)与v2(2), v3(3), v5(2) ✓
- v5(2)与v3(3), v4(1) ✓

**答案**：最少需要3种布线层。

**实际意义**：电路设计中，多层电路板需要为不同信号分配不同层，着色问题帮助最小化层数。

---

#### 例题3：交通信号灯调度

**题目**：某十字路口有5个车道交汇点（如图），每个交汇点需要设置信号灯。相邻的交汇点不能同时放行（会冲突）。问最少需要多少个相位（时间片）来调度所有信号灯？

```
      A
      |
  B---+---C
      |
      D
```
（中心点E连接A、B、C、D）

**详细解答**：

**步骤1：转化为图论问题**
- 顶点：A, B, C, D, E（5个交汇点）
- 边：A-E, B-E, C-E, D-E（相邻关系）
- 这是一个星形图，是平面图

**步骤2：分析着色数**
- 这是一个二部图（星形图总是二部图）
- 可以用2种颜色着色

**步骤3：实际着色**
- 颜色1（相位1）：A, C, E
- 颜色2（相位2）：B, D

**验证**：
- A与E相邻，但同在相位1？需要检查
- 实际上，中心点E与所有点相邻，所以E必须单独一个相位

重新分析：
- E与A、B、C、D都相邻
- A、B、C、D之间互不相邻
- 所以着色方案：
  - 相位1：A, C
  - 相位2：B, D
  - 相位3：E

**答案**：最少需要3个相位。

**实际意义**：交通工程中，交叉口信号灯的相位设计可以转化为图着色问题，帮助优化交通流。

---

#### 例题4：课程安排问题

**题目**：某学期有6门课程A、B、C、D、E、F，其中某些课程有先修关系或时间冲突（不能安排在同一时间段）。冲突关系如下：
- A与B、C冲突
- B与A、D冲突
- C与A、D、E冲突
- D与B、C、F冲突
- E与C、F冲突
- F与D、E冲突

问：最少需要多少个时间段才能安排完所有课程？

**详细解答**：

**步骤1：转化为图**
- 顶点：A, B, C, D, E, F
- 边：AB, AC, AD, BC, CD, CE, DE, EF, CF, DF
- 这与例题1的图相同

**步骤2：分析**
- 存在三角形A-C-D
- 所以着色数 ≥ 3

**步骤3：实际着色**
尝试3种颜色：
- 时间段1：A, E
- 时间段2：B, D, F
- 时间段3：C

验证：
- A(1)与B(2), C(3), D(2) ✓
- B(2)与A(1), D(2) ✗（B与D同色但相邻）

重新着色：
- 时间段1：A, E
- 时间段2：B, F
- 时间段3：C, D

验证：
- A(1)与B(2), C(3), D(3) ✗（A与D不同色，但A与C、D相邻，C和D同色没问题）

最终方案：
- 时间段1：A, E
- 时间段2：B, D
- 时间段3：C, F

**答案**：最少需要3个时间段。

**实际意义**：这是课程表编排的经典问题，帮助学校最小化教学资源使用。

---

#### 例题5：无线传感器网络频率分配

**题目**：某工厂有7个无线传感器，位置分布如下图。相邻传感器不能使用相同频率（会干扰）。求最少需要多少种频率？

```
   S1---S2
   | \ /|
   |  S3 |
   | / \|
   S4---S5
   |   |
   S6  S7
```
（S3连接S1、S2、S4、S5；S4连接S1、S3、S5、S6）

**详细解答**：

**步骤1：分析图的结构**
- 顶点：S1, S2, S3, S4, S5, S6, S7
- 边：S1-S2, S1-S3, S1-S4, S2-S3, S3-S4, S3-S5, S4-S5, S4-S6, S5-S7

**步骤2：判断着色数**
- 检查奇环：S1-S3-S4-S1（3个顶点）→ 奇环
- 所以着色数 ≥ 3

**步骤3：寻找最大团**
- 三角形：S1-S3-S4
- 所以至少需要3种颜色

**步骤4：实际着色**
尝试3种颜色：
- S1: 颜色1
- S2: 颜色2
- S3: 颜色3
- S4: 颜色2（与S1=1, S3=3相邻）
- S5: 颜色1（与S3=3, S4=2相邻）
- S6: 颜色3（只与S4=2相邻）
- S7: 颜色2（只与S5=1相邻）

**验证**：
- S1(1)与S2(2), S3(3), S4(2) ✓
- S2(2)与S1(1), S3(3) ✓
- S3(3)与S1(1), S2(2), S4(2), S5(1) ✓
- S4(2)与S1(1), S3(3), S5(1), S6(3) ✓
- S5(1)与S3(3), S4(2), S7(2) ✓
- S6(3)与S4(2) ✓
- S7(2)与S5(1) ✓

**答案**：最少需要3种频率。

**实际意义**：物联网中，传感器网络的频率分配直接影响通信效率和成本。

---

#### 例题6：小区基站覆盖问题

**题目**：某城市有5个小区，位置关系如下。相邻小区不能使用相同频段。求最少需要多少个频段？

```
   小区A
   /  \
小区B  小区C
  | \ / |
小区D  小区E
```
（A连接B、C；B连接A、C、D；C连接A、B、E；D连接B、E；E连接C、D）

**详细解答**：

**步骤1：转化为图**
- 顶点：A, B, C, D, E
- 边：A-B, A-C, B-C, B-D, C-E, D-E

**步骤2：分析结构**
- 这是一个平面图
- 检查二部性：存在三角形A-B-C-A
- 所以着色数 ≥ 3

**步骤3：实际着色**
尝试3种颜色：
- A: 颜色1
- B: 颜色2
- C: 颜色3
- D: 颜色3（与B=2相邻）
- E: 颜色2（与C=3相邻）

验证：
- A(1)与B(2), C(3) ✓
- B(2)与A(1), C(3), D(3) ✓
- C(3)与A(1), B(2), E(2) ✓
- D(3)与B(2), E(2) ✗（D与E相邻但同色）

重新着色：
- A: 颜色1
- B: 颜色2
- C: 颜色3
- D: 颜色1（与B=2相邻）
- E: 颜色1（与C=3相邻）

验证：
- D(1)与B(2), E(1) ✗（D与E同色但相邻）

再尝试：
- A: 颜色1
- B: 颜色2
- C: 颜色3
- D: 颜色3（与B=2相邻）
- E: 颜色1（与C=3相邻）

验证：
- D(3)与B(2), E(1) ✓
- E(1)与C(3), D(3) ✓

**答案**：最少需要3个频段。

**实际意义**：移动通信中，小区频率规划是网络优化的核心问题。

---

#### 例题7：地铁换乘站调度

**题目**：某城市地铁网络有6个换乘站，相邻换乘站不能同时进行列车调度。求最少需要多少个调度时段？

```
   站1---站2
   | \ / |
   |  站3  |
   | / \ |
   站4---站5
     |
    站6
```
（站3连接站1、站2、站4、站5；站4连接站1、站3、站5、站6）

**详细解答**：

**步骤1：分析图**
- 顶点：站1, 站2, 站3, 站4, 站5, 站6
- 边：站1-站2, 站1-站3, 站1-站4, 站2-站3, 站3-站4, 站3-站5, 站4-站5, 站4-站6

**步骤2：判断着色数**
- 奇环：站1-站3-站4-站1（3个顶点）
- 着色数 ≥ 3

**步骤3：实际着色**
- 站1: 颜色1
- 站2: 颜色2
- 站3: 颜色3
- 站4: 颜色2（与站1=1, 站3=3相邻）
- 站5: 颜色1（与站3=3, 站4=2相邻）
- 站6: 颜色3（只与站4=2相邻）

**验证**：
- 站1(1)与站2(2), 站3(3), 站4(2) ✓
- 站2(2)与站1(1), 站3(3) ✓
- 站3(3)与站1(1), 站2(2), 站4(2), 站5(1) ✓
- 站4(2)与站1(1), 站3(3), 站5(1), 站6(3) ✓
- 站5(1)与站3(3), 站4(2) ✓
- 站6(3)与站4(2) ✓

**答案**：最少需要3个调度时段。

**实际意义**：地铁运营调度中，换乘站的协调直接影响运输效率。

---

#### 例题8：图书馆分区管理

**题目**：某图书馆有7个阅览室，相邻阅览室不能同时进行噪音控制调整。求最少需要多少个调整批次？

```
   阅1---阅2
   | \ /|
   |  阅3 |
   | / \|
   阅4---阅5
   |   |
   阅6  阅7
```
（阅3连接阅1、阅2、阅4、阅5；阅4连接阅1、阅3、阅5、阅6）

**详细解答**：

**步骤1：分析图**
- 顶点：阅1, 阅2, 阅3, 阅4, 阅5, 阅6, 阅7
- 边：阅1-阅2, 阅1-阅3, 阅1-阅4, 阅2-阅3, 阅3-阅4, 阅3-阅5, 阅4-阅5, 阅4-阅6, 阅5-阅7

**步骤2：判断着色数**
- 奇环：阅1-阅3-阅4-阅1
- 着色数 ≥ 3

**步骤3：实际着色**
- 阅1: 颜色1
- 阅2: 颜色2
- 阅3: 颜色3
- 阅4: 颜色2（与阅1=1, 阅3=3相邻）
- 阅5: 颜色1（与阅3=3, 阅4=2相邻）
- 阅6: 颜色3（只与阅4=2相邻）
- 阅7: 颜色2（只与阅5=1相邻）

**验证**：所有相邻关系满足不同色。

**答案**：最少需要3个调整批次。

---

#### 例题9：工厂生产线调度

**题目**：某工厂有6个车间，相邻车间不能同时进行设备维护。求最少需要多少个维护时段？

```
   车间1
   /  \
车间2  车间3
  | \ / |
车间4  车间5
  |   |
车间6  车间7
```
（车间1连接车间2、车间3；车间2连接车间1、车间3、车间4；车间3连接车间1、车间2、车间5；车间4连接车间2、车间6；车间5连接车间3、车间7）

**详细解答**：

**步骤1：分析图**
- 顶点：1, 2, 3, 4, 5, 6, 7
- 边：1-2, 1-3, 2-3, 2-4, 3-5, 4-6, 5-7

**步骤2：判断着色数**
- 奇环：1-2-3-1（3个顶点）
- 着色数 ≥ 3

**步骤3：实际着色**
- 车间1: 颜色1
- 车间2: 颜色2
- 车间3: 颜色3
- 车间4: 颜色3（与车间2=2相邻）
- 车间5: 颜色2（与车间3=3相邻）
- 车间6: 颜色1（与车间4=3相邻）
- 车间7: 颜色1（与车间5=2相邻）

**验证**：
- 车间1(1)与车间2(2), 车间3(3) ✓
- 车间2(2)与车间1(1), 车间3(3), 车间4(3) ✓
- 车间3(3)与车间1(1), 车间2(2), 车间5(2) ✓
- 车间4(3)与车间2(2), 车间6(1) ✓
- 车间5(2)与车间3(3), 车间7(1) ✓
- 车间6(1)与车间4(3) ✓
- 车间7(1)与车间5(2) ✓

**答案**：最少需要3个维护时段。

---

#### 例题10：考试时间安排（实际考试题）

**题目**：某学期有8门课程需要考试，其中某些课程的学生有重叠，不能安排在同一时间。冲突关系如下：
- 课程1与课程2、3、4冲突
- 课程2与课程1、5冲突
- 课程3与课程1、4、6冲突
- 课程4与课程1、3、7冲突
- 课程5与课程2、8冲突
- 课程6与课程3、8冲突
- 课程7与课程4、8冲突
- 课程8与课程5、6、7冲突

问：最少需要安排多少场考试？

**详细解答**：

**步骤1：转化为图**
- 顶点：1, 2, 3, 4, 5, 6, 7, 8
- 边：1-2, 1-3, 1-4, 2-5, 3-4, 3-6, 4-7, 5-8, 6-8, 7-8

**步骤2：分析结构**
- 这是一个平面图
- 检查最大团：1-2-3-4中，1-2, 1-3, 1-4, 3-4，但2-3, 2-4无边
- 最大团是三角形：1-3-4
- 所以着色数 ≥ 3

**步骤3：实际着色**
尝试4种颜色：
- 考试1: 颜色1
- 考试2: 颜色2
- 考试3: 颜色3
- 考试4: 颜色4（与1=1, 3=3相邻）
- 考试5: 颜色3（与2=2相邻）
- 考试6: 颜色2（与3=3相邻）
- 考试7: 颜色2（与4=4相邻）
- 考试8: 颜色1（与5=3, 6=2, 7=2相邻）

**验证**：
- 1(1)与2(2), 3(3), 4(4) ✓
- 2(2)与1(1), 5(3) ✓
- 3(3)与1(1), 4(4), 6(2) ✓
- 4(4)与1(1), 3(3), 7(2) ✓
- 5(3)与2(2), 8(1) ✓
- 6(2)与3(3), 8(1) ✓
- 7(2)与4(4), 8(1) ✓
- 8(1)与5(3), 6(2), 7(2) ✓

**答案**：最少需要4场考试。

**实际意义**：这是教务管理的核心问题，直接影响教学资源的利用效率。

---

#### 例题11：5色定理的直观证明

**题目**：用实际例子说明为什么平面图中一定存在度数≤5的顶点。

**详细解答**：

**反证法思路**：
假设所有顶点度数≥6，考虑一个简单例子：

**例**：假设有一个平面图，所有顶点度数≥6
- 设图有n个顶点，m条边
- 根据握手定理：2m = Σd(v) ≥ 6n
- 所以 m ≥ 3n

**但平面图性质**：
- 对于简单平面图，m ≤ 3n - 6
- 这是因为每个面至少由3条边围成
- 每条边最多属于2个面
- 所以 3r ≤ 2m，结合欧拉公式 n - m + r = 2
- 得到 m ≤ 3n - 6

**矛盾**：
- m ≥ 3n 和 m ≤ 3n - 6 不能同时成立
- 所以假设错误，必存在度数≤5的顶点

**实际例子**：
考虑一个三角形网格：
```
   *---*
   | / |
   *---*
```
- 每个内部顶点度数=6
- 边界顶点度数<6
- 所以任何有限平面图都有边界，边界顶点度数较小

**结论**：平面图的边界性质保证了度数≤5的顶点必然存在。

---

#### 例题12：四色定理的实际意义

**题目**：为什么四色定理在实际地图制作中很重要？

**详细解答**：

**问题背景**：
- 地图着色要求：相邻区域不同色
- 目标：使用最少的颜色

**四色定理的意义**：
1. **理论保证**：任何平面地图最多需要4种颜色
2. **实际应用**：
   - 印刷成本：颜色越少，成本越低
   - 设计效率：4色足够，无需尝试更多颜色

**实际例子**：
```
   +-----+-----+
   |  A  |  B  |
   +-----+-----+
   |  C  |  D  |
   +-----+-----+
```
- A与B、C相邻
- B与A、D相邻
- C与A、D相邻
- D与B、C相邻
- 这是一个4-环，是二部图，只需要2种颜色

**复杂例子**：
```
   A---B
   |\ /|
   | C |
   |/ \|
   D---E
```
- 存在三角形A-C-D
- 需要3种颜色

**四色定理的紧性**：
- K₄（完全图4个顶点）是平面图
- 需要4种颜色
- 证明4是必要的

**实际意义**：
- 地图出版商：保证4色足够
- GIS系统：着色算法的理论基础
- 资源优化：避免使用不必要颜色

---

#### 例题13：平面性判定的实际方法

**题目**：如何在实际中判断一个图是否为平面图？

**详细解答**：

**方法1：欧拉公式验证**
- 计算顶点数n、边数m
- 如果 m > 3n - 6，一定不是平面图
- 例：K₅，n=5, m=10, 3×5-6=9, 10>9，非平面

**方法2：寻找K₅或K₃,₃**
- K₅：5个顶点，每对都有边
- K₃,₃：3+3个顶点，二部完全图
- 如果图包含它们的细分，非平面

**方法3：实际画法**
- 尝试在平面上画出无交叉边的图形
- 例：K₄可以画成四面体投影，是平面图

**实际例子**：
判断下图是否平面：
```
   A---B
   | \ |
   |  \|
   C---D
```
- n=4, m=5
- 3×4-6=6, 5≤6，满足必要条件
- 可以画成无交叉，是平面图

**方法4：使用算法**
- Hopcroft-Tarjan算法：O(n)时间
- 实际软件：Graphviz等工具可以自动判断

**结论**：实际中结合必要条件和画法验证最常用。

---

#### 例题14：着色算法的实际应用

**题目**：使用贪心算法为实际网络着色。

**详细解答**：

**贪心算法步骤**：
1. 按度数从大到小排序顶点
2. 依次为每个顶点分配最小可用颜色

**实际例子**：
```
   A---B
   | \ |
   |  \|
   C---D
```
度数：A=3, B=2, C=2, D=2

**步骤**：
1. A: 颜色1
2. B: 颜色2（与A相邻）
3. C: 颜色2（与A=1相邻，可用2）
4. D: 颜色3（与A=1, B=2, C=2相邻）

**结果**：使用3种颜色

**实际应用**：
- 无线网络：分配信道
- 课程表：安排考试时间
- 交通灯：相位调度

**算法复杂度**：
- 时间：O(n + m)
- 空间：O(n)
- 保证：对平面图最多4种颜色

---

#### 例题15：综合应用题

**题目**：某城市规划5个功能区，相邻区域不能有相同功能。求最少需要多少种功能类型？

```
   商业区
   /    \
住宅区  政府区
  | \  / |
工业区  教育区
```
（商业区连接住宅区、政府区；住宅区连接商业区、政府区、工业区；政府区连接商业区、住宅区、教育区；工业区连接住宅区、教育区；教育区连接政府区、工业区）

**详细解答**：

**步骤1：分析图**
- 顶点：商业、住宅、政府、工业、教育
- 边：商业-住宅, 商业-政府, 住宅-政府, 住宅-工业, 政府-教育, 工业-教育

**步骤2：判断着色数**
- 奇环：商业-住宅-政府-商业（3个顶点）
- 着色数 ≥ 3

**步骤3：实际着色**
- 商业: 类型1
- 住宅: 类型2
- 政府: 类型3
- 工业: 类型3（与住宅=2相邻）
- 教育: 类型2（与政府=3相邻）

**验证**：
- 商业(1)与住宅(2), 政府(3) ✓
- 住宅(2)与商业(1), 政府(3), 工业(3) ✓
- 政府(3)与商业(1), 住宅(2), 教育(2) ✓
- 工业(3)与住宅(2), 教育(2) ✓
- 教育(2)与政府(3), 工业(3) ✓

**答案**：最少需要3种功能类型。

**实际意义**：城市规划中，功能区的合理划分直接影响城市运行效率。

---

## 2. 欧拉公式

### 📖 欧拉公式

**欧拉公式**：连通平面图 \(G\) 的顶点数、边数和面数分别为 \(n, m\) 和 \(r\)，则有：

\[
n - m + r = 2
\]

### 💡 简单平面图的必要条件

设 \(G\) 是 \(n(n \geq 3)\) 阶 \(m\) 条边的简单平面图，则：

\[
m \leq 3n - 6
\]

**重要说明**：
- 一个简单连通图，若不满足 \(m \leq 3n - 6\)，则一定是非平面图
- 但满足该不等式的简单连通图**未必是平面图**（只是必要条件，不是充分条件）

### 📝 例题

**例题1**：设 \(G\) 是连通平面图，有5个顶点，6个面，则 \(G\) 的边数是（ ）。

A. 5条

B. 6条

C. 9条

D. 11条

<details>
<summary><strong>点击查看答案</strong></summary>

**解答**：

**使用欧拉公式**：\(n - m + r = 2\)

已知：\(n = 5\)，\(r = 6\)

\[
5 - m + 6 = 2 \Rightarrow m = 9
\]

**答案**：C（但选项中没有9，检查题目）

重新计算：\(5 - m + 6 = 2 \Rightarrow m = 9\)

但选项A是5，可能题目有误。根据欧拉公式，答案应该是9。

如果按照选项，可能是：\(5 - 5 + 6 = 6 \neq 2\)，不对。

**正确答案**：根据欧拉公式，\(m = n + r - 2 = 5 + 6 - 2 = 9\)

但选项中没有9，可能是题目数据有误。按公式计算应该是9。

</details>

---

**例题2**：图 \(G\) 是一个简单的连通平面图，顶点数为8，其无限面的次数为5，其余面都为三角形（次数为3），计算平面图的边数和面数。

<details>
<summary><strong>点击查看答案</strong></summary>

**解答**：

**设平面图 \(G\) 的边数为 \(m\)，面数为 \(r\)**

**使用欧拉公式**：
\[
n - m + r = 2 \Rightarrow 8 - m + r = 2
\]

**使用面的次数性质**：
所有面的次数之和 = \(2m\)

\[
5 + 3(r - 1) = 2m
\]

**联立求解**：
\[
\begin{cases}
8 - m + r = 2 \\
5 + 3(r - 1) = 2m
\end{cases}
\]

\[
\begin{cases}
m = r + 6 \\
5 + 3r - 3 = 2m \\
2 + 3r = 2(r + 6) \\
2 + 3r = 2r + 12 \\
r = 10 \\
m = 16
\end{cases}
\]

**答案**：边数为16，面数为10

</details>

---

**例题3**：设图 \(G\) 有 \(V\) 个结点 \(e\) 条边，当 \(V > 3\)，若不满足 \(e \leq 3V - 6\)，它一定不是平面图。（）

<details>
<summary><strong>点击查看答案</strong></summary>

**解答**：

**正确** ✅

**说明**：
- \(m \leq 3n - 6\) 是简单平面图的**必要条件**
- 若不满足这个条件，则图一定不是平面图
- 但满足这个条件不一定就是平面图

**答案**：正确

</details>

---

## 3. 练习题

### 练习1

5个结点的简单平面图的边数最多是（ ）。

A. 7

B. 8

C. 9

D. 10

<details>
<summary><strong>点击查看答案</strong></summary>

**解答**：

**使用简单平面图的必要条件**：\(m \leq 3n - 6\)

\(n = 5\)：
\[
m \leq 3 \times 5 - 6 = 15 - 6 = 9
\]

**答案**：C

</details>

---

### 练习2

二部图 \(K_{2,3}\) 是（ ）。

A. 欧拉图

B. 哈密顿图

C. 非平面图

D. 平面图

<details>
<summary><strong>点击查看答案</strong></summary>

**解答**：

**\(K_{2,3}\) 的性质**：

**平面性**：
- \(K_{2,n}(n \geq 2)\) 都是平面图
- 所以 \(K_{2,3}\) 是平面图 ✅

**欧拉性**：
- 需要检查度数（无向图需要所有顶点度数为偶数）
- \(K_{2,3}\) 中，2个顶点的度数为3，3个顶点的度数为2
- 有奇度顶点，所以不是欧拉图 ❌

**哈密顿性**：
- 需要检查是否存在哈密顿回路
- \(K_{2,3}\) 不一定有哈密顿回路 ❌

**答案**：D

</details>

---

### 练习3

若简单连通图 \(G\) 有4个结点，3个面，则 \(G\) 有（ ）条边。

A. 3

B. 4

C. 5

D. 6

<details>
<summary><strong>点击查看答案</strong></summary>

**解答**：

**使用欧拉公式**：\(n - m + r = 2\)

已知：\(n = 4\)，\(r = 3\)

\[
4 - m + 3 = 2 \Rightarrow m = 5
\]

**答案**：C

</details>

---

### 练习4

设 \(G\) 是连通平面图，有 \(v\) 个顶点，\(e\) 条边，\(r\) 个面，则 \(v - e + r =\underline{\quad}\)。

<details>
<summary><strong>点击查看答案</strong></summary>

**解答**：

**欧拉公式**：对于连通平面图，\(n - m + r = 2\)

**答案**：2

</details>

---

### 练习5

设简单平面图 \(G\) 有 \(n\) 个顶点，\(m\) 条边，且 \(n \geq 3\)，则 \(m \leq\underline{\quad}\)。

<details>
<summary><strong>点击查看答案</strong></summary>

**解答**：

**简单平面图的必要条件**：\(m \leq 3n - 6\)

**答案**：\(3n - 6\)

</details>

---

## 📌 总结

### 关键要点

1. **平面图**：
   - 定义：能画在平面上使得除顶点处外无边相交
   - 常见的平面图：\(K_1, K_2, K_3, K_4, K_{1,n}, K_{2,n}\)
   - 非平面图：\(K_5, K_{3,3}\)

2. **欧拉公式**：
   - 连通平面图：\(n - m + r = 2\)
   - 其中 \(n\) 是顶点数，\(m\) 是边数，\(r\) 是面数

3. **简单平面图的必要条件**：
   - \(m \leq 3n - 6\)（\(n \geq 3\)）
   - 不满足一定不是平面图，满足不一定就是平面图

4. **面的次数**：
   - 所有面的次数之和 = \(2m\)

5. **着色定理**：
   - 五色定理：任何平面图都可以用至多5种颜色着色
   - 四色定理：任何平面图都可以用至多4种颜色着色
   - 关键引理：平面图中存在度数 ≤ 5 的顶点

### 记忆技巧

- **欧拉公式**：\(n - m + r = 2\)（顶点 - 边 + 面 = 2）
- **简单平面图条件**：\(m \leq 3n - 6\)
- **非平面图**：\(K_5\) 和 \(K_{3,3}\)
- **面的次数**：总和等于边数的2倍
- **五色定理证明**：归纳法 + 度数引理 + 颜色交换
- **四色定理**：计算机证明，1976年

### 常见题型

1. **平面性判定**：检查是否包含 \(K_5\) 或 \(K_{3,3}\)
2. **欧拉公式计算**：已知两个求第三个
3. **边数上限**：使用 \(m \leq 3n - 6\)
4. **着色问题**：判断着色数，给出着色方案
5. **证明题**：五色定理证明，引理证明

### 易错点

1. 混淆平面图和非平面图的判定条件
2. 忘记欧拉公式只适用于连通图
3. \(m \leq 3n - 6\) 是必要条件，不是充分条件
4. 五色定理和四色定理的证明方法不同
5. 着色时忘记检查奇环和团结构

---
